<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <!-- Adapt to mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <!-- Force full-screen display when launched from home screen -->
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <!-- Set status bar color -->
    <meta name="theme-color" content="#000000">
    <!-- Link to the manifest file -->
    <link rel="manifest" href="manifest.json">
    <!-- Icons for iOS -->
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <title>Countdown Timer</title>
    <style>
        :root {
            --bg-color: #000000;
            --timer-color: #FFFFFF;
            --control-bg-color: #333;
            --control-text-color: #FFFFFF;
            --accent-color: #ff5722;
        }
        html,
        body {
            width: 100%;
            height: 100%;
            margin: 0;
            padding: 0;
            overflow: hidden;
            -webkit-overflow-scrolling: touch;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
        }
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            text-align: center;
            background-color: var(--bg-color);
            color: var(--timer-color);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            touch-action: none; /* Prevent accidental scroll */
            height: 100vh;
            width: 100vw;
        }
        #timer {
            font-size: calc(20vmin);
            margin: 0;
            color: var(--timer-color);
            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1;
            user-select: none;
            width: 100%;
            height: auto;
        }
        .controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex;
            justify-content: center;
            gap: 1em;
            padding: 0 1em;
        }
        .controls button {
            font-size: 1em;
            padding: 0.5em;
            border: none;
            background-color: var(--control-bg-color);
            color: var(--control-text-color);
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        .controls button:hover {
            color: var(--accent-color);
            background-color: #444;
        }
        .controls button svg {
            width: 24px;
            height: 24px;
        }
        .settings-popup {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            top: 0;
            background-color: rgba(0, 0, 0, 0.9);
            justify-content: center;
            align-items: center;
            padding: 1em;
            z-index: 1000;
            overflow-y: auto;
        }
        .settings-content {
            background-color: #2c2c2c;
            padding: 1.5em;
            border-radius: 15px;
            width: 100%;
            max-width: 350px;
            text-align: center;
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.7);
        }
        .settings-content h3 {
            margin-top: 0;
            color: #fff;
            text-align: center;
        }
        .settings-content label {
            margin: 1em 0 0.5em;
            display: block;
            font-size: 1em;
            color: #fff;
        }
        .settings-content input {
            width: calc(100% - 1em);
            padding: 0.5em;
            margin-bottom: 1em;
            border: none;
            border-radius: 5px;
            background-color: #444;
            color: #fff;
        }
        #close-settings {
            margin-top: 1em;
            padding: 0.7em;
            background-color: var(--accent-color);
            color: #fff;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            width: 100%;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        }
        /* Install button styles */
        #install-button {
            position: fixed;
            bottom: 80px;
            left: 50%;
            transform: translateX(-50%);
            padding: 10px 20px;
            font-size: 16px;
            background-color: var(--accent-color);
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: none; /* Hidden by default */
        }
    </style>
</head>
<body>
    <div id="timer">01:00</div>
    <div class="controls">
        <button id="settings-button" aria-label="Settings">
            <svg viewBox="0 0 24 24">
                <!-- Gear icon -->
                <path fill="currentColor" d="M12 15.5C13.93 15.5 15.5 13.93 15.5 12S13.93 8.5 12 8.5 8.5 10.07 8.5 12 10.07 15.5 12 15.5M19.43 12.97C19.46 12.65 19.5 12.33 19.5 12S19.46 11.35 19.43 11.03L21.5 9.9 19.95 7.05 17.75 7.5C17.32 6.85 16.77 6.27 16.13 5.75L16.5 3.5 13.5 2 12 4.5C11.67 4.5 11.33 4.5 11 4.5S10.33 4.5 10 4.5L8.5 2 5.5 3.5 5.87 5.75C5.23 6.27 4.68 6.85 4.25 7.5L2.05 7.05 0.5 9.9 2.57 11.03C2.54 11.35 2.5 11.67 2.5 12S2.54 12.65 2.57 12.97L0.5 14.1 2.05 16.95 4.25 16.5C4.68 17.15 5.23 17.73 5.87 18.25L5.5 20.5 8.5 22 10 19.5C10.33 19.5 10.67 19.5 11 19.5S11.67 19.5 12 19.5L13.5 22 16.5 20.5 16.13 18.25C16.77 17.73 17.32 17.15 17.75 16.5L19.95 16.95 21.5 14.1 19.43 12.97Z" />
            </svg>
        </button>
        <button id="start" aria-label="Start">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M8 5v14l11-7z"/>
            </svg>
        </button>
        <button id="pause" aria-label="Pause">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
            </svg>
        </button>
       <button id="reset" aria-label="Reset">
            <svg viewBox="0 0 24 24">
                <path fill="currentColor" d="M13 3a9 9 0 0 0-9 9H1l3.89 3.89.07.14L9 12H5a7 7 0 1 1 7 7 7 7 0 0 1-1-.07v2.02A9 9 0 1 0 13 3Z"/>
            </svg>
        </button>
    </div>

    <div class="settings-popup" id="settings">
        <div class="settings-content">
            <h3>Settings</h3>
            <label for="time-input">Set Timer (minutes)</label>
            <input type="number" id="time-input" placeholder="1" step="any"/>
            <label for="bg-color-input">Background Color</label>
            <input type="color" id="bg-color-input" value="#000000"/>
            <label for="font-color-input">Font Color</label>
            <input type="color" id="font-color-input" value="#FFFFFF"/>
            <button id="close-settings">Close</button>
        </div>
    </div>

    <button id="install-button">Install App</button>

    <script>
        let countdown;
        let timeRemaining = 60; // default 1 minute in seconds
        let initialTime = 60;   // store the initial time set by the user

        const timerDisplay = document.getElementById('timer');
        const settingsButton = document.getElementById('settings-button');
        const settingsPopup = document.getElementById('settings');
        const closeSettingsButton = document.getElementById('close-settings');
        const startButton = document.getElementById('start');
        const pauseButton = document.getElementById('pause');
        const resetButton = document.getElementById('reset');
        const timeInput = document.getElementById('time-input');
        const bgColorInput = document.getElementById('bg-color-input');
        const fontColorInput = document.getElementById('font-color-input');

        // Display time in mm:ss format
        function displayTime(seconds) {
            const minutes = Math.floor(seconds / 60);
            const remainderSeconds = seconds % 60;
            const display = `${minutes < 10 ? '0' : ''}${minutes}:${remainderSeconds < 10 ? '0' : ''}${remainderSeconds}`;
            timerDisplay.textContent = display;
        }

        // Timer logic
        function startTimer() {
            clearInterval(countdown);
            const now = Date.now();
            const then = now + timeRemaining * 1000;
            displayTime(timeRemaining);
            countdown = setInterval(() => {
                timeRemaining = Math.round((then - Date.now()) / 1000);
                if (timeRemaining < 0) {
                    clearInterval(countdown);
                    return;
                }
                displayTime(timeRemaining);
            }, 1000);
        }

        function pauseTimer() {
            clearInterval(countdown);
        }

        function resetTimer() {
            clearInterval(countdown);
            timeRemaining = initialTime;
            displayTime(timeRemaining);
        }

        // Event listeners
        settingsButton.addEventListener('click', () => {
            settingsPopup.style.display = 'flex';
        });

        closeSettingsButton.addEventListener('click', () => {
            settingsPopup.style.display = 'none';
        });

        startButton.addEventListener('click', startTimer);
        pauseButton.addEventListener('click', pauseTimer);
        resetButton.addEventListener('click', resetTimer);

        // Update settings
        timeInput.addEventListener('change', () => {
            const minutes = parseFloat(timeInput.value);
            if (!isNaN(minutes) && minutes >= 0) {
                timeRemaining = Math.round(minutes * 60);
                initialTime = timeRemaining; // Store the initial time
                displayTime(timeRemaining);
            }
        });

        bgColorInput.addEventListener('input', () => {
            document.documentElement.style.setProperty('--bg-color', bgColorInput.value);
        });

        fontColorInput.addEventListener('input', () => {
            document.documentElement.style.setProperty('--timer-color', fontColorInput.value);
        });

        // Fullscreen handling for iPhone Safari
        function requestFullScreen() {
            const docElm = document.documentElement;
            if (docElm.requestFullscreen) {
                docElm.requestFullscreen();
            } else if (docElm.mozRequestFullScreen) {
                docElm.mozRequestFullScreen(); // Firefox
            } else if (docElm.webkitRequestFullScreen) {
                docElm.webkitRequestFullScreen(); // Chrome, Safari, Opera
            } else if (docElm.msRequestFullscreen) {
                docElm.msRequestFullscreen(); // IE/Edge
            }
        }

        // Request fullscreen when the device rotates to landscape
        window.addEventListener('orientationchange', () => {
            if (window.orientation === 90 || window.orientation === -90) {
                requestFullScreen();
            }
        });

        // Initial display
        displayTime(timeRemaining);
        timeInput.value = '1'; // Set default input value to 1 minute
    </script>
</body>
</html>